<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>MS — Contador de Actividades</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="noindex">
  <link rel="stylesheet" href="./style.css" />
</head>

<body class="page-left">
  <header>
    <div class="wrap">
      <h1>MS — Contador de Actividades</h1>
      <div class="bar">

        <button id="btnSync" class="btn">Sincronizar</button>

        <button id="downloadCSV" class="btn">Descargar CSV (Backup)</button>
        <button id="btnBulk" class="btn warn">Bulk import</button>
        <span id="dbStatus" class="pill">DB: —</span>
      </div>

    </div>
  </header>

  <!-- Layout con barra izquierda (Notas) -->
  <main class="wrap layout">
    <!-- Lateral izquierda -->
    <aside class="side">
      <div class="card">
        <div class="notes-header">
          <button id="addNote" class="btn-icon" title="Agregar nota al inicio">➕</button>
          <input type="text" id="searchNotes" placeholder="Buscar notas..." class="notes-search" />
        </div>
        <div id="quickNotes" class="notes-area" contenteditable="true" spellcheck="false"
          placeholder="Escribe aquí tus apuntes, tareas, pendientes…"></div>
        <div id="notesStatus" class="muted">—</div>

        <!-- separador visual -->
        <hr class="sep" />

        <!-- Herramienta: Generador de link de WhatsApp -->
        <div class="wa-tools">
          <label for="waQuick" class="wa-title">Link rápido de WhatsApp</label>
          <input id="waQuick" class="wa-input" type="text" placeholder="+966 59 388 0414 o 966593880414" />
          <div class="wa-actions">
            <button id="waCopy" class="btn pill btn-wa-copy" title="Copiar link">
              Copiar link
            </button>
            <button id="waOpen" class="btn pill btn-wa-open" title="Abrir en nueva pestaña">
              Abrir
            </button>
            <button id="waClear" class="btn pill" title="Limpiar campo">
              Clear
            </button>
          </div>
          <p class="muted" style="margin-top:6px;font-size:.8rem">
            Tip: al hacer clic en un WhatsApp de la tabla, se copia el número y se prepara
            el link aquí.
          </p>
        </div>
        <!-- /WhatsApp tools -->
      </div>
    </aside>

    <!-- Columna principal -->
    <section class="content">
      <div class="sectionbar">
        <h2 class="h2">Registrar actividad</h2>
        <div class="bar-btns">
          <button id="clearAllFields" class="btn danger">Clear all</button>
          <button id="clearForms" class="btn ghost">Clear</button>
        </div>
      </div>

      <div class="actions">
        <!-- 1 (Antes 2) -->
        <div class="row t2">
          <button class="tag tag-btn" id="pasteRow2">1) Resuelta su consulta de WhatsApp</button>
          <div class="email">
            <label>Email</label>
            <input id="em2" type="email" placeholder="email@dominio.com" />
          </div>
          <div class="wa">
            <label>WhatsApp</label>
            <input id="wa2" type="text" placeholder="+51 999 888 777" />
          </div>
          <div class="comment">
            <label>Comentario</label>
            <input id="co2" type="text" placeholder="Notas breves (opcional)" />
          </div>
          <div class="row-btns">
            <button class="btn primary" id="b2">Agregar</button>
            <button class="btn small orange" id="findEmail2" title="Buscar por Email">Email</button>
            <button class="btn small purple" id="findWa2" title="Buscar por WhatsApp">WA</button>
          </div>
        </div>

        <!-- 2 (Antes 3) -->
        <div class="row t3">
          <button class="tag tag-btn" id="pasteRow3">2) Resuelta consulta de Email</button>
          <div class="email">
            <label>Email</label>
            <input id="em3" type="email" placeholder="email@dominio.com" />
          </div>
          <div class="wa">
            <label>WhatsApp</label>
            <input id="wa3" type="text" placeholder="+51 999 888 777" />
          </div>
          <div class="comment">
            <label>Comentario</label>
            <input id="co3" type="text" placeholder="Notas breves (opcional)" />
          </div>
          <div class="row-btns">
            <button class="btn primary" id="b3">Agregar</button>
            <button class="btn small orange" id="findEmail3" title="Buscar por Email">Email</button>
            <button class="btn small purple" id="findWa3" title="Buscar por WhatsApp">WA</button>
          </div>
        </div>
      </div>

      <h2 class="h2">Registros</h2>
      <div class="searchbar">
        <button id="btnPaste" class="btn" title="Pegar del portapapeles" style="margin-right: 4px;">Paste</button>
        <input id="q" type="text" placeholder="Buscar en tabla… (tipo, email, whatsapp, comentario)" />
        <select id="stateSel" class="btn">
          <option value="all" selected>Todos</option>
          <option value="pending">Pendientes</option>
          <option value="done">Completados</option>
          <option value="whatsapp">WhatsApp</option>
          <option value="email">Email</option>
        </select>
        <button id="clearQ" class="btn">Clear</button>
      </div>

      <div class="card p0" id="tableCard">
        <table>
          <thead>
            <tr>
              <th style="width:60px;">#</th>
              <th id="thDate" class="thclick">Fecha ▼</th>
              <th>Tipo</th>
              <th>Email</th>
              <th>WhatsApp</th>
              <th>Estado</th>
              <th>Comentario</th>
              <th style="width:1%;">Acciones</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
      <div id="pagination" class="pagination" style="display:none;"></div>
    </section>
  </main>

  <footer class="wrap">
    <div class="footerbar">
      <button id="saveNow" class="btn">Guardar ahora</button>
      <span class="status pill" id="status">Listo.</span>
    </div>
  </footer>

  <!-- Diálogo Bulk import -->
  <dialog id="dlgBulk" class="dialog">
    <h3>Bulk import (email, whatsapp)</h3>
    <p class="muted">
      Una fila por contacto. Separador: <b>coma</b> o <b>tab</b>. Ejemplos:<br />
      <code>correo@dominio.com, +51 999 888 777</code>
    </p>
    <textarea id="bulkText" rows="10" placeholder="email, whatsapp&#10;email2@dominio.com, +51 900 000 000"></textarea>
    <div class="actions-end">
      <button id="bulkCancel" class="btn">Cancelar</button>
      <button id="bulkImport" class="btn primary">Importar</button>
    </div>
  </dialog>



  <!-- Diálogo Auth -->
  <dialog id="dlgAuth" class="dialog" style="text-align:center;">
    <h3>Acceso Restringido</h3>
    <p>Ingresa el PIN de acceso:</p>
    <input type="password" id="authPin" placeholder="PIN"
      style="font-size:1.5rem; text-align:center; width:120px; margin:10px auto; display:block;" />
    <button id="btnAuth" class="btn primary">Ingresar</button>
  </dialog>

  <script type="module" src="./app.js"></script>
</body>

</html>